(function(){var H=CKEDITOR.htmlParser.fragment.prototype,D=CKEDITOR.htmlParser.element.prototype;H.onlyChild=D.onlyChild=function(){var b=this.children,a=b.length,c=(a==1)&&b[0];return c||null};D.removeAnyChildWithName=function(b){var c=this.children,a=[],e;for(var d=0;d<c.length;d++){e=c[d];if(!e.name){continue}if(e.name==b){a.push(e);c.splice(d--,1)}a=a.concat(e.removeAnyChildWithName(b))}return a};D.getAncestor=function(b){var a=this.parent;while(a&&!(a.name&&a.name.match(b))){a=a.parent}return a};H.firstChild=D.firstChild=function(c){var a;for(var b=0;b<this.children.length;b++){a=this.children[b];if(c(a)){return a}else{if(a.name){a=a.firstChild(c);if(a){return a}}}}return null};D.addStyle=function(b,d,e){var c,a="";if(typeof d=="string"){a+=b+":"+d+";"}else{if(typeof b=="object"){for(var f in b){if(b.hasOwnProperty(f)){a+=f+":"+b[f]+";"}}}else{a+=b}e=d}if(!this.attributes){this.attributes={}}c=this.attributes.style||"";c=(e?[a,c]:[c,a]).join(";");this.attributes.style=c.replace(/^;|;(?=;)/,"")};D.getStyle=function(b){var a=this.attributes.style;if(a){a=CKEDITOR.tools.parseCssText(a,1);return a[b]}};CKEDITOR.dtd.parentOf=function(c){var a={};for(var b in this){if(b.indexOf("$")==-1&&this[b][c]){a[b]=1}}return a};function K(d){var i=d.children,j,b,e=d.children.length,f,c,a=/list-style-type:(.*?)(?:;|$)/,g=CKEDITOR.plugins.pastefromword.filters.stylesFilter;b=d.attributes;if(a.exec(b.style)){return}for(var h=0;h<e;h++){j=i[h];if(j.attributes.value&&Number(j.attributes.value)==h+1){delete j.attributes.value}f=a.exec(j.attributes.style);if(f){if(f[1]==c||!c){c=f[1]}else{c=null;break}}}if(c){for(h=0;h<e;h++){b=i[h].attributes;b.style&&(b.style=g([["list-style-type"]])(b.style)||"")}d.addStyle("list-style-type",c)}}var E=/^([.\d]*)+(em|ex|px|gd|rem|vw|vh|vm|ch|mm|cm|in|pt|pc|deg|rad|ms|s|hz|khz){1}?/i;var B=/^(?:\b0[^\s]*\s*){1,4}$/;var I="^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$",z=new RegExp(I),N=new RegExp(I.toUpperCase());var v={decimal:/\d+/,"lower-roman":z,"upper-roman":N,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},A={disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/},y={ol:v,ul:A},x=[[1000,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],u="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function J(c){c=c.toUpperCase();var b=x.length,d=0;for(var e=0;e<b;++e){for(var f=x[e],a=f[1].length;c.substr(0,a)==f[1];c=c.substr(a)){d+=f[0]}}return d}function G(b){b=b.toUpperCase();var d=u.length,c=1;for(var a=1;b.length>0;a*=d){c+=u.indexOf(b.charAt(b.length-1))*a;b=b.substr(0,b.length-1)}return c}var w=0,F=null,L;var M=(CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(a,c){var b=new CKEDITOR.htmlParser.element("cke:listbullet");b.attributes={"cke:listsymbol":a[0]};b.add(new CKEDITOR.htmlParser.text(c));return b},isListBulletIndicator:function(b){var a=b.attributes&&b.attributes.style;if(/mso-list\s*:\s*Ignore/i.test(a)){return true}},isContainingOnlySpaces:function(b){var a;return((a=b.onlyChild())&&(/^(:?\s|&nbsp;)+$/).test(a.value))},resolveList:function(c){var b=c.attributes,a;if((a=c.removeAnyChildWithName("cke:listbullet"))&&a.length&&(a=a[0])){c.name="cke:li";if(b.style){b.style=M.filters.stylesFilter([["text-indent"],["line-height"],[(/^margin(:?-left)?$/),null,function(d){var e=d.split(" ");d=CKEDITOR.tools.convertToPx(e[3]||e[1]||e[0]);if(!w&&F!==null&&d>F){w=d-F}F=d;b["cke:indent"]=w&&(Math.ceil(d/w)+1)||1}],[(/^mso-list$/),null,function(d){d=d.split(" ");var e=Number(d[0].match(/\d+/)),f=Number(d[1].match(/\d+/));if(f==1){e!==L&&(b["cke:reset"]=1);L=e}b["cke:indent"]=f}]])(b.style,c)||""}if(!b["cke:indent"]){F=0;b["cke:indent"]=1}CKEDITOR.tools.extend(b,a.attributes);return true}else{L=F=w=null}return false},getStyleComponents:(function(){var a=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;"></div>',CKEDITOR.document);CKEDITOR.document.getBody().append(a);return function(c,e,d){a.setStyle(c,e);var b={},f=d.length;for(var g=0;g<f;g++){b[d[g]]=a.getStyle(d[g])}return b}})(),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(a,i){i=typeof i=="number"?i:1;var h=a.attributes,b;switch(h.type){case"a":b="lower-alpha";break;case"1":b="decimal";break}var e=a.children,f;for(var m=0;m<e.length;m++){f=e[m];if(f.name in CKEDITOR.dtd.$listItem){var c=f.attributes,g=f.children,l=g.length,k=g[l-1];if(k.name in CKEDITOR.dtd.$list){a.add(k,m+1);if(!--g.length){e.splice(m--,1)}}f.name="cke:li";h.start&&!m&&(c.value=h.start);M.filters.stylesFilter([["tab-stops",null,function(n){var o=n.split(" ")[1].match(E);o&&(F=CKEDITOR.tools.convertToPx(o[0]))}],(i==1?["mso-list",null,function(n){n=n.split(" ");var o=Number(n[0].match(/\d+/));o!==L&&(c["cke:reset"]=1);L=o}]:null)])(c.style);c["cke:indent"]=i;c["cke:listtype"]=a.name;c["cke:list-style-type"]=b}else{if(f.name in CKEDITOR.dtd.$list){arguments.callee.apply(this,[f,i+1]);e=e.slice(0,m).concat(f.children).concat(e.slice(m+1));a.children=[];for(var d=0,j=e.length;d<j;d++){a.add(e[d])}}}}delete a.name;h["cke:list"]=1},assembleList:function(Q){var o=Q.children,s,j,m,g,p,q,d,a=[],c,e;var b,f,k,t;for(var i=0;i<o.length;i++){s=o[i];if("cke:li"==s.name){s.name="li";j=s;m=j.attributes;b=m["cke:listsymbol"];b=b&&b.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);f=k=t=null;if(m["cke:ignored"]){o.splice(i--,1);continue}m["cke:reset"]&&(d=p=q=null);g=Number(m["cke:indent"]);if(g!=p){e=c=null}if(!b){f=m["cke:listtype"]||"ol";k=m["cke:list-style-type"]}else{if(e&&y[e][c].test(b[1])){f=e;k=c}else{for(var l in y){for(var r in y[l]){if(y[l][r].test(b[1])){if(l=="ol"&&(/alpha|roman/).test(r)){var h=/roman/.test(r)?J(b[1]):G(b[1]);if(!t||h<t){t=h;f=l;k=r}}else{f=l;k=r;break}}}}}!f&&(f=b[2]?"ol":"ul")}e=f;c=k||(f=="ol"?"decimal":"disc");if(k&&k!=(f=="ol"?"decimal":"disc")){j.addStyle("list-style-type",k)}if(f=="ol"&&b){switch(k){case"decimal":t=Number(b[1]);break;case"lower-roman":case"upper-roman":t=J(b[1]);break;case"lower-alpha":case"upper-alpha":t=G(b[1]);break}j.attributes.value=t}if(!d){a.push(d=new CKEDITOR.htmlParser.element(f));d.add(j);o[i]=d}else{if(g>p){a.push(d=new CKEDITOR.htmlParser.element(f));d.add(j);q.add(d)}else{if(g<p){var R=p-g,n;while(R--&&(n=d.parent)){d=n.parent}d.add(j)}else{d.add(j)}}o.splice(i--,1)}q=j;p=g}else{if(d){d=p=q=null}}}for(i=0;i<a.length;i++){K(a[i])}d=p=q=L=F=w=null},falsyFilter:function(a){return false},stylesFilter:function(a,b){return function(c,e){var d=[];(c||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(n,g,k){g=g.toLowerCase();g=="font-family"&&(k=k.replace(/["']/g,""));var l,h,j,i;for(var m=0;m<a.length;m++){if(a[m]){l=a[m][0];h=a[m][1];j=a[m][2];i=a[m][3];if(g.match(l)&&(!h||k.match(h))){g=i||g;b&&(j=j||k);if(typeof j=="function"){j=j(k,e,g)}if(j&&j.push){g=j[0],j=j[1]}if(typeof j=="string"){d.push([g,j])}return}}}!b&&d.push([g,k])});for(var f=0;f<d.length;f++){d[f]=d[f].join(":")}return d.length?(d.join(";")+";"):false}},elementMigrateFilter:function(b,a){return b?function(d){var c=a?new CKEDITOR.style(b,a)._.definition:b;d.name=c.element;CKEDITOR.tools.extend(d.attributes,CKEDITOR.tools.clone(c.attributes));d.addStyle(CKEDITOR.style.getStyleText(c))}:function(){}},styleMigrateFilter:function(a,c){var b=this.elementMigrateFilter;return a?function(e,f){var g=new CKEDITOR.htmlParser.element(null),d={};d[c]=e;b(a,d)(g);g.children=f.children;f.children=[g];g.filter=function(){};g.parent=f}:function(){}},bogusAttrFilter:function(a,b){if(b.name.indexOf("cke:")==-1){return false}},applyStyleFilter:null},getRules:function(g,o){var e=CKEDITOR.dtd,t=CKEDITOR.tools.extend({},e.$block,e.$listItem,e.$tableContent),a=g.config,i=this.filters,b=i.falsyFilter,r=i.stylesFilter,n=i.elementMigrateFilter,p=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),s=this.utils.createListBulletMarker,l=i.flattenList,j=i.assembleList,k=this.utils.isListBulletIndicator,P=this.utils.isContainingOnlySpaces,f=this.utils.resolveList,h=function(O){O=CKEDITOR.tools.convertToPx(O);return isNaN(O)?O:O+"px"},d=this.utils.getStyleComponents,c=this.utils.listDtdParents,m=a.pasteFromWordRemoveFontStyles!==false,q=a.pasteFromWordRemoveStyles!==false;return{elementNames:[[(/meta|link|script/),""]],root:function(O){O.filterChildren(o);j(O)},elements:{"^":function(R){var O;if(CKEDITOR.env.gecko&&(O=i.applyStyleFilter)){O(R)}},$:function(O){var T=O.name||"",U=O.attributes;if(T in t&&U.style){U.style=r([[(/^(:?width|height)$/),null,h]])(U.style)||""}if(T.match(/h\d/)){O.filterChildren(o);if(f(O)){return}n(a["format_"+T])(O)}else{if(T in e.$inline){O.filterChildren(o);if(P(O)){delete O.name}}else{if(T.indexOf(":")!=-1&&T.indexOf("cke")==-1){O.filterChildren(o);if(T=="v:imagedata"){var V=O.attributes["o:href"];if(V){O.attributes.src=V}O.name="img";return}delete O.name}}}if(T in c){O.filterChildren(o);j(O)}},style:function(U){if(CKEDITOR.env.gecko){var V=U.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/),T=V&&V[1],O={};if(T){T.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(aa,Q,R){Q=Q.split(",");var ab=Q.length,Z;for(var S=0;S<ab;S++){CKEDITOR.tools.trim(Q[S]).replace(/^(\w+)(\.[\w-]+)?$/g,function(Y,W,X){W=W||"*";X=X.substring(1,X.length);if(X.match(/MsoNormal/)){return}if(!O[W]){O[W]={}}if(X){O[W][X]=R}else{O[W]=R}})}});i.applyStyleFilter=function(X){var Q=O["*"]?"*":X.name,R=X.attributes&&X.attributes["class"],S;if(Q in O){S=O[Q];if(typeof S=="object"){S=S[R]}S&&X.addStyle(S,true)}}}}return false},p:function(S){if((/MsoListParagraph/i).exec(S.attributes["class"])||S.getStyle("mso-list")){var O=S.firstChild(function(Q){return Q.type==CKEDITOR.NODE_TEXT&&!P(Q.parent)});var T=O&&O.parent;if(T){T.addStyle("mso-list","Ignore")}}S.filterChildren(o);if(f(S)){return}if(a.enterMode==CKEDITOR.ENTER_BR){delete S.name;S.add(new CKEDITOR.htmlParser.element("br"))}else{n(a["format_"+(a.enterMode==CKEDITOR.ENTER_P?"p":"div")])(S)}},div:function(U){var T=U.onlyChild();if(T&&T.name=="table"){var V=U.attributes;T.attributes=CKEDITOR.tools.extend(T.attributes,V);V.style&&T.addStyle(V.style);var O=new CKEDITOR.htmlParser.element("div");O.addStyle("clear","both");U.add(O);delete U.name}},td:function(O){if(O.getAncestor("thead")){O.name="th"}},ol:l,ul:l,dl:l,font:function(U){if(k(U.parent)){delete U.name;return}U.filterChildren(o);var V=U.attributes,O=V.style,T=U.parent;if("font"==T.name){CKEDITOR.tools.extend(T.attributes,U.attributes);O&&T.addStyle(O);delete U.name}else{O=O||"";if(V.color){V.color!="#000000"&&(O+="color:"+V.color+";");delete V.color}if(V.face){O+="font-family:"+V.face+";";delete V.face}if(V.size){O+="font-size:"+(V.size>3?"large":(V.size<3?"small":"medium"))+";";delete V.size}U.name="span";U.addStyle(O)}},span:function(Z){if(k(Z.parent)){return false}Z.filterChildren(o);if(P(Z)){delete Z.name;return null}if(k(Z)){var aa=Z.firstChild(function(Q){return Q.value||Q.name=="img"});var ag=aa&&(aa.value||"l."),ae=ag&&ag.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);if(ae){var O=s(ae,ag);var ah=Z.getAncestor("span");if(ah&&(/ mso-hide:\s*all|display:\s*none /).test(ah.attributes.style)){O.attributes["cke:ignored"]=1}return O}}var ab=Z.children,ad=Z.attributes,ac=ad&&ad.style,af=ab&&ab[0];if(ac){ad.style=r([["line-height"],[(/^font-family$/),null,!m?p(a.font_style,"family"):null],[(/^font-size$/),null,!m?p(a.fontSize_style,"size"):null],[(/^color$/),null,!m?p(a.colorButton_foreStyle,"color"):null],[(/^background-color$/),null,!m?p(a.colorButton_backStyle,"color"):null]])(ac,Z)||""}if(!ad.style){delete ad.style}if(CKEDITOR.tools.isEmpty(ad)){delete Z.name}return null},b:n(a.coreStyles_bold),i:n(a.coreStyles_italic),u:n(a.coreStyles_underline),s:n(a.coreStyles_strike),sup:n(a.coreStyles_superscript),sub:n(a.coreStyles_subscript),a:function(O){var R=O.attributes;if(R&&!R.href&&R.name){delete O.name}else{if(CKEDITOR.env.webkit&&R.href&&R.href.match(/file:\/\/\/[\S]+#/i)){R.href=R.href.replace(/file:\/\/\/[^#]+/i,"")}}},"cke:listbullet":function(O){if(O.getAncestor(/h\d/)&&!a.pasteFromWordNumberedHeadingToList){delete O.name}}},attributeNames:[[(/^onmouse(:?out|over)/),""],[(/^onload$/),""],[(/(?:v|o):\w+/),""],[(/^lang/),""]],attributes:{style:r(q?[[(/^list-style-type$/),null],[(/^margin$|^margin-(?!bottom|top)/),null,function(O,T,U){if(T.name in {p:1,div:1}){var V=a.contentsLangDirection=="ltr"?"margin-left":"margin-right";if(U=="margin"){O=d(U,O,[V])[V]}else{if(U!=V){return null}}if(O&&!B.test(O)){return[V,O]}}return null}],[(/^clear$/)],[(/^border.*|margin.*|vertical-align|float$/),null,function(O,R){if(R.name=="img"){return O}}],[(/^width|height$/),null,function(O,R){if(R.name in {table:1,td:1,th:1,img:1}){return O}}]]:[[(/^mso-/)],[(/-color$/),null,function(O){if(O=="transparent"){return false}if(CKEDITOR.env.gecko){return O.replace(/-moz-use-text-color/g,"transparent")}}],[(/^margin$/),B],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],m?[(/font-?/)]:null],q),width:function(O,R){if(R.name in e.$tableContent){return false}},border:function(O,R){if(R.name in e.$tableContent){return false}},"class":b,bgcolor:b,valign:q?b:function(O,R){R.addStyle("vertical-align",O);return false}},comment:!CKEDITOR.env.ie?function(ag,ac){var af=ag.match(/<img.*?>/),ab=ag.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);if(ab){var Z=ab[1]||(af&&"l."),ah=Z&&Z.match(/>(?:[(]?)([^\s]+?)([.)]?)</);return s(ah,Z)}if(CKEDITOR.env.gecko&&af){var aa=CKEDITOR.htmlParser.fragment.fromHtml(af[0]).children[0],O=ac.previous,ae=O&&O.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/),ad=ae&&ae[1];ad&&(aa.attributes.src=ad);return aa}return false}:b}}});var C=function(){this.dataFilter=new CKEDITOR.htmlParser.filter()};C.prototype={toHtml:function(c){var b=CKEDITOR.htmlParser.fragment.fromHtml(c),a=new CKEDITOR.htmlParser.basicWriter();b.writeHtml(a,this.dataFilter);return a.getHtml(true)}};CKEDITOR.cleanWord=function(c,a){if(CKEDITOR.env.gecko){c=c.replace(/(<!--\[if[^<]*?\])-->([\S\s]*?)<!--(\[endif\]-->)/gi,"$1$2$3")}if(CKEDITOR.env.webkit){c=c.replace(/(class="MsoListParagraph[^>]+><!--\[if !supportLists\]-->)([^<]+<span[^<]+<\/span>)(<!--\[endif\]-->)/gi,"$1<span>$2</span>$3")}var b=new C(),d=b.dataFilter;d.addRules(CKEDITOR.plugins.pastefromword.getRules(a,d));a.fire("beforeCleanWord",{filter:d});c=c.replace(/cke:.*?".*?"/g,"");c=c.replace(/style=""/g,"");c=c.replace(/<span>/g,"");return c}})();